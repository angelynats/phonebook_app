{"version":3,"sources":["utils/hoc/withAuthRedirect.js","utils/validation.js","components/LoginForm/LoginForm.module.css","pages/LoginPage/LoginPage.module.css","components/LoginForm/LoginForm.js","pages/LoginPage/LoginPage.js"],"names":["withAuthRedirect","BaseComponent","authenticated","useSelector","state","sessionSelectors","history","useHistory","location","useLocation","useEffect","replace","from","rulesSignup","name","email","password","rulesLogin","rulesContact","number","messages","required","field","module","exports","LoginForm","useState","setEmail","setPassword","errors","setErrors","dispatch","useDispatch","onSubmit","e","preventDefault","validateAll","then","data","sessionOperations","catch","formattedErrors","forEach","error","message","className","styles","form","noValidate","inputs","htmlFor","label","autoFocus","id","type","value","onChange","target","input","button","main","main_login","header","header_secondary","to","link"],"mappings":"kJAuCeA,IAjCU,SAAAC,GA8BvB,OA7ByB,WACvB,IAAMC,EAAgBC,aAAY,SAAAC,GAAK,OACrCC,IAAiCD,MAE7BE,EAAUC,cACVC,EAAWC,cAqBjB,OAnBAC,qBAAU,WACHR,GAGLI,EAAQK,QAAQ,eAEf,IAEHD,qBAAU,WACR,GAAKR,EAGL,OAAIM,EAASJ,OAASI,EAASJ,MAAMQ,KAC5BN,EAAQK,QAAQH,EAASJ,MAAMQ,WAGxCN,EAAQK,QAAQ,eACf,CAACT,EAAeI,EAASE,EAASJ,QAE9B,cAACH,EAAD,O,iCCjCX,wIAAO,IAAMY,EAAc,CACzBC,KAAM,kBACNC,MAAO,iBACPC,SAAU,yBAGCC,EAAa,CACxBF,MAAO,iBACPC,SAAU,yBAGCE,EAAe,CAC1BJ,KAAM,kBACNK,OAAQ,yBAGGC,EAAW,CACtBC,SAAU,SAAAC,GAAK,kBAASA,EAAT,iBACf,cAAe,uCACf,eAAgB,uCAChB,aAAc,yC,oBCnBhBC,EAAOC,QAAU,CAAC,KAAO,wBAAwB,OAAS,0BAA0B,MAAQ,yBAAyB,MAAQ,yBAAyB,MAAQ,yBAAyB,OAAS,4B,oBCAhMD,EAAOC,QAAU,CAAC,KAAO,wBAAwB,WAAa,8BAA8B,OAAS,0BAA0B,iBAAmB,oCAAoC,KAAO,0B,uIC8D9KC,EAxDG,WAAO,IAAD,EACIC,mBAAS,IADb,mBACfX,EADe,KACRY,EADQ,OAEUD,mBAAS,IAFnB,mBAEfV,EAFe,KAELY,EAFK,OAGMF,mBAAS,MAHf,mBAGfG,EAHe,KAGPC,EAHO,KAKhBC,EAAWC,cAejB,OACE,uBAAMC,SAda,SAAAC,GACnBA,EAAEC,iBACFC,sBAAY,CAAErB,QAAOC,YAAYC,IAAYG,KAC1CiB,MAAK,SAAAC,GACJP,EAASQ,IAAwBD,OAElCE,OAAM,SAAAX,GACL,IAAMY,EAAkB,GACxBZ,EAAOa,SAAQ,SAAAC,GAAK,OAAKF,EAAgBE,EAAMrB,OAASqB,EAAMC,WAC9Dd,EAAUW,OAKgBI,UAAWC,IAAOC,KAAMC,YAAU,EAAhE,UACE,sBAAKH,UAAWC,IAAOG,OAAvB,UACE,wBAAOC,QAAQ,QAAQL,UAAWC,IAAOK,MAAzC,kBAEE,uBACEC,WAAS,EACTC,GAAG,QACHC,KAAK,QACLxC,KAAK,QACLyC,MAAOxC,EACPyC,SAAU,SAAAtB,GAAC,OAAIP,EAASO,EAAEuB,OAAOF,QACjCV,UAAWC,IAAOY,QAEnB7B,GAAU,sBAAMgB,UAAWC,IAAOH,MAAxB,SAAgCd,EAAOd,WAEpD,wBAAOmC,QAAQ,WAAWL,UAAWC,IAAOK,MAA5C,qBAEE,uBACEE,GAAG,WACHC,KAAK,WACLxC,KAAK,WACLyC,MAAOvC,EACPwC,SAAU,SAAAtB,GAAC,OAAIN,EAAYM,EAAEuB,OAAOF,QACpCV,UAAWC,IAAOY,QAEnB7B,GAAU,sBAAMgB,UAAWC,IAAOH,MAAxB,SAAgCd,EAAOb,iBAGtD,wBAAQsC,KAAK,SAAST,UAAWC,IAAOa,OAAxC,wB,kBCnCS3D,uBAfG,WAChB,OACE,sBAAM6C,UAAWC,IAAOc,KAAxB,SACE,sBAAKf,UAAWC,IAAOe,WAAvB,UACE,oBAAIhB,UAAWC,IAAOgB,OAAtB,oBACA,cAAC,EAAD,IACA,mBAAGjB,UAAWC,IAAOiB,iBAArB,gBACA,cAAC,IAAD,CAASC,GAAG,UAAUnB,UAAWC,IAAOmB,KAAxC","file":"static/js/login-page.19e54793.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { useHistory, useLocation } from 'react-router-dom';\r\n\r\nimport { useSelector } from 'react-redux';\r\nimport * as sessionSelectors from '../../redux/session/sessionSelectors';\r\n\r\nconst withAuthRedirect = BaseComponent => {\r\n  const WithAuthRedirect = () => {\r\n    const authenticated = useSelector(state =>\r\n      sessionSelectors.isAuthenticated(state),\r\n    );\r\n    const history = useHistory();\r\n    const location = useLocation();\r\n\r\n    useEffect(() => {\r\n      if (!authenticated) {\r\n        return;\r\n      }\r\n      history.replace('/contacts');\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n      if (!authenticated) {\r\n        return;\r\n      }\r\n      if (location.state && location.state.from) {\r\n        return history.replace(location.state.from);\r\n      }\r\n\r\n      history.replace('/contacts');\r\n    }, [authenticated, history, location.state]);\r\n\r\n    return <BaseComponent />;\r\n  };\r\n\r\n  return WithAuthRedirect;\r\n};\r\n\r\nexport default withAuthRedirect;\r\n","export const rulesSignup = {\r\n  name: 'required|string',\r\n  email: 'required|email',\r\n  password: 'required|string|min:6',\r\n};\r\n\r\nexport const rulesLogin = {\r\n  email: 'required|email',\r\n  password: 'required|string|min:6',\r\n};\r\n\r\nexport const rulesContact = {\r\n  name: 'required|string',\r\n  number: 'required|string|min:8',\r\n};\r\n\r\nexport const messages = {\r\n  required: field => `* ${field} is required`,\r\n  'email.email': '* please enter a valid email address',\r\n  'password.min': '* must be at least 6 characters long',\r\n  'number.min': '* must be at least 8 characters long',\r\n};\r\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"form\":\"LoginForm_form__JyP2S\",\"inputs\":\"LoginForm_inputs__2P4bF\",\"label\":\"LoginForm_label__1COFw\",\"input\":\"LoginForm_input__10YyP\",\"error\":\"LoginForm_error__DWfkp\",\"button\":\"LoginForm_button__3rpBU\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"main\":\"LoginPage_main__ZnrhY\",\"main_login\":\"LoginPage_main_login__1092p\",\"header\":\"LoginPage_header__2AGyL\",\"header_secondary\":\"LoginPage_header_secondary__3inFh\",\"link\":\"LoginPage_link__kg78G\"};","import React, { useState } from 'react';\r\nimport { useDispatch } from 'react-redux';\r\nimport { validateAll } from 'indicative/validator';\r\nimport { rulesLogin, messages } from '../../utils/validation';\r\nimport * as sessionOperations from '../../redux/session/sessionOperations';\r\nimport styles from './LoginForm.module.css';\r\n\r\nconst LoginForm = () => {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [errors, setErrors] = useState(null);\r\n\r\n  const dispatch = useDispatch();\r\n\r\n  const handleSubmit = e => {\r\n    e.preventDefault();\r\n    validateAll({ email, password }, rulesLogin, messages)\r\n      .then(data => {\r\n        dispatch(sessionOperations.login(data));\r\n      })\r\n      .catch(errors => {\r\n        const formattedErrors = {};\r\n        errors.forEach(error => (formattedErrors[error.field] = error.message));\r\n        setErrors(formattedErrors);\r\n      });\r\n  };\r\n\r\n  return (\r\n    <form onSubmit={handleSubmit} className={styles.form} noValidate>\r\n      <div className={styles.inputs}>\r\n        <label htmlFor=\"email\" className={styles.label}>\r\n          Email\r\n          <input\r\n            autoFocus\r\n            id=\"email\"\r\n            type=\"email\"\r\n            name=\"email\"\r\n            value={email}\r\n            onChange={e => setEmail(e.target.value)}\r\n            className={styles.input}\r\n          />\r\n          {errors && <span className={styles.error}>{errors.email}</span>}\r\n        </label>\r\n        <label htmlFor=\"password\" className={styles.label}>\r\n          Password\r\n          <input\r\n            id=\"password\"\r\n            type=\"password\"\r\n            name=\"password\"\r\n            value={password}\r\n            onChange={e => setPassword(e.target.value)}\r\n            className={styles.input}\r\n          />\r\n          {errors && <span className={styles.error}>{errors.password}</span>}\r\n        </label>\r\n      </div>\r\n      <button type=\"submit\" className={styles.button}>\r\n        LOG IN\r\n      </button>\r\n    </form>\r\n  );\r\n};\r\n\r\nexport default LoginForm;\r\n","import React from 'react';\r\nimport { NavLink } from 'react-router-dom';\r\nimport withAuthRedirect from '../../utils/hoc/withAuthRedirect';\r\nimport LoginForm from '../../components/LoginForm/LoginForm';\r\nimport styles from './LoginPage.module.css';\r\n\r\nconst LoginPage = () => {\r\n  return (\r\n    <main className={styles.main}>\r\n      <div className={styles.main_login}>\r\n        <h1 className={styles.header}>LOG IN</h1>\r\n        <LoginForm />\r\n        <p className={styles.header_secondary}>or</p>\r\n        <NavLink to=\"/signup\" className={styles.link}>\r\n          SIGN UP\r\n        </NavLink>\r\n      </div>\r\n    </main>\r\n  );\r\n};\r\n\r\nexport default withAuthRedirect(LoginPage);\r\n"],"sourceRoot":""}